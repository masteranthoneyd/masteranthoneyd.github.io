<!doctype html><html class="theme-next muse use-motion" lang=en><meta name=generator content="Hexo 3.9.0"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta http-equiv=content-language content=zh-cn><script src=//cdn.bootcss.com/pace/1.0.2/pace.min.js></script><link href=//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css rel=stylesheet><style>.pace .pace-progress{background:#ff009e;height:2px}.pace .pace-progress-inner{box-shadow:0 0 10px #e6006b,0 0 5px #ff009e}.pace .pace-activity{border-top-color:#ff009e;border-left-color:#ff009e}</style><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel=stylesheet><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel=stylesheet><link href="/css/main.css?v=5.1.0" rel=stylesheet><meta name=keywords content="Java,Design Pattern,"><link rel=alternate href=/atom.xml title="ookamiAntD's Blog" type=application/atom+xml><link rel="shortcut icon" type=image/x-icon href="/favicon.png?v=5.1.0"><meta name=description content="Preface 创建型模式(Creational Pattern)对类的实例化过程进行了抽象, 能够将软件模块中对象的创建和对象的使用分离. 为了使软件的结构更加清晰, 外界对于这些对象只需要知道它们共同的接口, 而不清楚其具体的实现细节, 使整个系统的设计更加符合单一职责原则.  创建型模式在创建什么(What), 由谁创建(Who), 何时创建(When)等方面都为软件设计者提供了尽可能大的"><meta name=keywords content="Java,Design Pattern"><meta property=og:type content=article><meta property=og:title content=设计模式之创建型(Creational)><meta property=og:url content=http://yangbingdong.com/2018/design-pattern-creational/index.html><meta property=og:site_name content="ookamiAntD's Blog"><meta property=og:description content="Preface 创建型模式(Creational Pattern)对类的实例化过程进行了抽象, 能够将软件模块中对象的创建和对象的使用分离. 为了使软件的结构更加清晰, 外界对于这些对象只需要知道它们共同的接口, 而不清楚其具体的实现细节, 使整个系统的设计更加符合单一职责原则.  创建型模式在创建什么(What), 由谁创建(Who), 何时创建(When)等方面都为软件设计者提供了尽可能大的"><meta property=og:locale content=en><meta property=og:image content=https://cdn.yangbingdong.com/img/design-pattern/design-pattern-creation.jpg><meta property=og:image content=https://cdn.yangbingdong.com/img/design-pattern-creational/singleton.png><meta property=og:image content=https://cdn.yangbingdong.com/img/design-pattern-creational/simple-factory.png><meta property=og:image content=https://cdn.yangbingdong.com/img/design-pattern-creational/factory-method.png><meta property=og:image content=https://cdn.yangbingdong.com/img/design-pattern-creational/abstract-factory.png><meta property=og:updated_time content=2020-04-07T10:15:47.010Z><meta name=twitter:card content=summary><meta name=twitter:title content=设计模式之创建型(Creational)><meta name=twitter:description content="Preface 创建型模式(Creational Pattern)对类的实例化过程进行了抽象, 能够将软件模块中对象的创建和对象的使用分离. 为了使软件的结构更加清晰, 外界对于这些对象只需要知道它们共同的接口, 而不清楚其具体的实现细节, 使整个系统的设计更加符合单一职责原则.  创建型模式在创建什么(What), 由谁创建(Who), 何时创建(When)等方面都为软件设计者提供了尽可能大的"><meta name=twitter:image content=https://cdn.yangbingdong.com/img/design-pattern/design-pattern-creation.jpg><script id=hexo.configurations>var NexT=window.NexT||{};var CONFIG={root:'/',scheme:'Muse',sidebar:{"position":"right","display":"always"},fancybox:true,motion:true,duoshuo:{userId:'undefined',author:'Author'},algolia:{applicationID:'RI3NF6GUI0',apiKey:'3d33fa60ba30d3b17f37220bb1a36749',indexName:'blogIndex',hits:{"per_page":10},labels:{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}}};</script><link rel=canonical href=http://yangbingdong.com/2018/design-pattern-creational/><script>(function(){if(''){if(prompt('请输入文章密码')!==''){alert('密码错误！');history.back();}}})();</script><title>设计模式之创建型(Creational) | ookamiAntD's Blog</title><body itemscope itemtype=http://schema.org/WebPage lang=en><script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?e9505ac4e11d464329d615553a72b526";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><div class="container one-collumn sidebar-position-right page-post-detail"><div class=headband></div><a href=https://github.com/masteranthoneyd/blog rel="external nofollow noopener noreferrer" target=_blank><img style=position:absolute;top:0;left:0;border:0 src=https://camo.githubusercontent.com/82b228a3648bf44fc1163ef44c62fcc60081495e/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e706e67 alt="Fork me on GitHub" data-canonical-src=https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png></a><header id=header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-meta><div class=custom-logo-site-title><a href=/ class=brand rel=start><span class=logo-line-before><i></i></span><span class=site-title>ookamiAntD's Blog</span>
<span class=logo-line-after><i></i></span></a></div><h1 class=site-subtitle itemprop=description>Easy coding,easy life.</h1></div><div class=site-nav-toggle><button>
<span class=btn-bar></span><span class=btn-bar></span><span class=btn-bar></span></button></div><nav class=site-nav><ul id=menu class=menu><li class="menu-item menu-item-home"><a href=/ rel=section><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a><li class="menu-item menu-item-archives"><a href=/archives rel=section><i class="menu-item-icon fa fa-fw fa-archive"></i><br>Archives</a><li class="menu-item menu-item-categories"><a href=/categories rel=section><i class="menu-item-icon fa fa-fw fa-th"></i><br>Categories</a><li class="menu-item menu-item-tags"><a href=/tags rel=section><i class="menu-item-icon fa fa-fw fa-tags"></i><br>Tags</a><li class="menu-item menu-item-about"><a href=/about rel=section><i class="menu-item-icon fa fa-fw fa-user"></i><br>About</a><li class="menu-item menu-item-guestbook"><a href=/guestbook rel=section><i class="menu-item-icon fa fa-fw fa-commenting"></i><br>Message</a><li class="menu-item menu-item-search"><a href=javascript:; class=popup-trigger><i class="menu-item-icon fa fa-search fa-fw"></i><br>Search</a></ul><div class=site-search><div class=popup><span class="search-icon fa fa-search"></span><input id=local-search-input><div id=local-search-result></div><span class=popup-btn-close>close</span></div></div></nav></div></header><main id=main class=main><div class=main-inner><div class=content-wrap><div id=content class=content><div id=posts class=posts-expand><article class="post post-type-normal" itemscope itemtype=http://schema.org/Article><link itemprop=mainEntityOfPage href=http://yangbingdong.com/2018/design-pattern-creational/><span style=display:none itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=name content=ookamiAntD><meta itemprop=description content><meta itemprop=image content=/images/avatar/avatar-admin.jpg></span><span style=display:none itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="ookamiAntD's Blog"><span style=display:none itemprop=logo itemscope itemtype=http://schema.org/ImageObject><img style=display:none itemprop="url image" alt="ookamiAntD's Blog" src></span></span><header class=post-header><h2 class=post-title itemprop="name headline">设计模式之创建型(Creational)</h2><div class=post-meta><span class=post-time><span class=post-meta-item-icon><i class="fa fa-calendar-o"></i></span><span class=post-meta-item-text>Posted on</span>
<time title="Post created" itemprop="dateCreated datePublished" datetime=2018-07-12T14:34:52+08:00>2018-07-12</time></span>
<span class=post-category><span class=post-meta-divider>|</span>
<span class=post-meta-item-icon><i class="fa fa-folder-o"></i></span><span class=post-meta-item-text>In</span>
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/Programming/ itemprop=url rel=index><span itemprop=name>Programming</span></a></span>
,
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/Programming/Java/ itemprop=url rel=index><span itemprop=name>Java</span></a></span>
,
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/Programming/Java/Design-Pattern/ itemprop=url rel=index><span itemprop=name>Design Pattern</span></a></span></span>
<span id=/2018/design-pattern-creational/ class=leancloud_visitors data-flag-title=设计模式之创建型(Creational)><span class=post-meta-divider>|</span>
<span class=post-meta-item-icon><i class="fa fa-eye"></i></span><span class=post-meta-item-text>Visitors</span>
<span class=leancloud-visitors-count></span></span><br><span class=post-time><span class=post-meta-item-icon><i class="fa fa-edit"></i></span><span class=post-meta-item-text>WordCount:</span>
<span class=post-count>4,469字</span>
<span class=post-meta-divider>|</span>
<span class=post-meta-item-text>min2read:</span>
<span class=post-count>19分钟</span></span></div></header><div class=post-body itemprop=articleBody><link rel=stylesheet href=https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css><p><img src=https://cdn.yangbingdong.com/img/design-pattern/design-pattern-creation.jpg alt><h1 id=Preface><a href=#Preface class=headerlink title=Preface></a>Preface</h1><blockquote><p>创建型模式(<code>Creational Pattern</code>)对类的实例化过程进行了抽象, 能够将软件模块中对象的创建和对象的使用分离. 为了使软件的结构更加清晰, 外界对于这些对象只需要知道它们共同的接口, 而不清楚其具体的实现细节, 使整个系统的设计更加符合单一职责原则.<p>创建型模式在创建什么(What), 由谁创建(Who), 何时创建(When)等方面都为软件设计者提供了尽可能大的灵活性. 创建型模式隐藏了类的实例的创建细节, 通过隐藏对象如何被创建和组合在一起达到使整个系统独立的目的.</blockquote><a id=more></a><h1 id=Singleton-Pattern><a href=#Singleton-Pattern class=headerlink title="Singleton Pattern"></a>Singleton Pattern</h1><blockquote><p>单例模式可以说简单, 也可以说不简单. . . 使用不当就是小学生了</blockquote><p><img src=https://cdn.yangbingdong.com/img/design-pattern-creational/singleton.png alt><p>这么说吧, 一个城市只能有一个市长, 每当需要他的时候他总会出现, 并且每次都是同一个人. 总不能一个城市有两个市长吧？<br>那么单例模式就是保证一个类只有一个实例化对象, 并提供一个全局访问入口.<br>本质就是控制实例的数量.<h2 id=小学生式单例模式><a href=#小学生式单例模式 class=headerlink title=小学生式单例模式></a>小学生式单例模式</h2><p>现在来看一个最原始的单例:<br><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.yangbingdong.singleton;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * <span class=doctag>@author</span> ybd</span></span><br><span class=line><span class=comment> * <span class=doctag>@date</span> 17-10-16</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 小学生式单例模式</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>SimpleSingleton</span> </span>&#123;</span><br><span class=line></span><br><span class=line>	<span class=keyword>private</span> <span class=keyword>static</span> SimpleSingleton instance;</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>private</span> <span class=title>SimpleSingleton</span><span class=params>()</span> </span>&#123;&#125;</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>static</span> SimpleSingleton <span class=title>getInstance</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		<span class=keyword>if</span> (instance == <span class=keyword>null</span>) &#123;</span><br><span class=line>			instance = <span class=keyword>new</span> SimpleSingleton();</span><br><span class=line>		&#125;</span><br><span class=line>		<span class=keyword>return</span> instance;</span><br><span class=line>	&#125;</span><br><span class=line></span><br><span class=line>&#125;</span><br></pre></table></figure><p>如果是刚入门的程序猿这可以得到101分（多一份骄傲）<br>但若是已出来工作的写出这样的代码. . . 那是找群殴. . .<p>单例模式中注重的是<strong>单</strong>字, 上面代码有可能造成多个实例, 来一段多线程测试代码:<br><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br><span class=line>44</span><br><span class=line>45</span><br><span class=line>46</span><br><span class=line>47</span><br><span class=line>48</span><br><span class=line>49</span><br><span class=line>50</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.yangbingdong.singleton;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.HashSet;</span><br><span class=line><span class=keyword>import</span> java.util.Set;</span><br><span class=line><span class=keyword>import</span> java.util.concurrent.CountDownLatch;</span><br><span class=line><span class=keyword>import</span> java.util.concurrent.CyclicBarrier;</span><br><span class=line><span class=keyword>import</span> java.util.concurrent.ExecutorService;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> <span class=keyword>static</span> java.util.Collections.synchronizedSet;</span><br><span class=line><span class=keyword>import</span> <span class=keyword>static</span> java.util.concurrent.Executors.newCachedThreadPool;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * <span class=doctag>@author</span> ybd</span></span><br><span class=line><span class=comment> * <span class=doctag>@date</span> 17-10-18</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>SingletonTest</span> </span>&#123;</span><br><span class=line>	<span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>final</span> <span class=keyword>int</span> NUM = <span class=number>1000</span>;</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> <span class=keyword>throws</span> Exception </span>&#123;</span><br><span class=line>		ExecutorService executorService = newCachedThreadPool();</span><br><span class=line>		<span class=keyword>try</span> &#123;</span><br><span class=line>			CyclicBarrier cyclicBarrier = <span class=keyword>new</span> CyclicBarrier(NUM);</span><br><span class=line>			CountDownLatch countDownLatch = <span class=keyword>new</span> CountDownLatch(NUM);</span><br><span class=line>			Set&lt;String&gt; set = synchronizedSet(<span class=keyword>new</span> HashSet&lt;String&gt;());</span><br><span class=line>			<span class=keyword>for</span> (<span class=keyword>int</span> i = <span class=number>0</span>; i &lt; NUM; i++) &#123;</span><br><span class=line>				executorService.execute(() -&gt; &#123;</span><br><span class=line>					<span class=keyword>try</span> &#123;</span><br><span class=line>						<span class=comment>/* 阻塞并等待所有线程加载完毕再同时run */</span></span><br><span class=line>						cyclicBarrier.await();</span><br><span class=line>						SimpleSingleton singleton = SimpleSingleton.getInstance();</span><br><span class=line>						set.add(singleton.toString());</span><br><span class=line>					&#125; <span class=keyword>catch</span> (Exception e) &#123;</span><br><span class=line>						e.printStackTrace();</span><br><span class=line>					&#125; <span class=keyword>finally</span> &#123;</span><br><span class=line>						<span class=comment>/* 计数器用于阻塞主线程 */</span></span><br><span class=line>						countDownLatch.countDown();</span><br><span class=line>					&#125;</span><br><span class=line>				&#125;);</span><br><span class=line>			&#125;</span><br><span class=line>			<span class=comment>/* 阻塞主线程, 等待所有线程跑完再执行下面 */</span></span><br><span class=line>			countDownLatch.await();</span><br><span class=line>			System.out.println(<span class=string>"------并发情况下我们取到的实例------"</span>);</span><br><span class=line>			set.forEach(System.out::println);</span><br><span class=line>		&#125; <span class=keyword>catch</span> (Exception e) &#123;</span><br><span class=line>			e.printStackTrace();</span><br><span class=line>		&#125; <span class=keyword>finally</span> &#123;</span><br><span class=line>			executorService.shutdown();</span><br><span class=line>		&#125;</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>执行结果:<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line>------并发情况下我们取到的实例------</span><br><span class=line>com.yangbingdong.singleton.SimpleSingleton@<span class=number>3</span>bf59e6d</span><br><span class=line>com.yangbingdong.singleton.SimpleSingleton@<span class=number>4e593</span>af6</span><br><span class=line>com.yangbingdong.singleton.SimpleSingleton@<span class=number>7</span>eac491e</span><br></pre></table></figure><p>很明显的产生了<strong>多个实例</strong>, 三个线程同时通过了<code>instance == null</code>条件.<h2 id=饿汉式><a href=#饿汉式 class=headerlink title=饿汉式></a>饿汉式</h2><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.yangbingdong.singleton;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * <span class=doctag>@author</span> ybd</span></span><br><span class=line><span class=comment> * <span class=doctag>@date</span> 17-10-19</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 饿汉式</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>EagerSingleton</span> </span>&#123;</span><br><span class=line>	<span class=keyword>private</span> <span class=keyword>static</span> EagerSingleton instance = <span class=keyword>new</span> EagerSingleton();</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>private</span> <span class=title>EagerSingleton</span><span class=params>()</span> </span>&#123;&#125;</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>static</span> EagerSingleton <span class=title>getInstance</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		<span class=keyword>return</span> instance;</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>通过<strong>类加载</strong>保证了线程安全, <strong>空间换时间</strong>.<h2 id=懒汉式><a href=#懒汉式 class=headerlink title=懒汉式></a>懒汉式</h2><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.yangbingdong.singleton;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * <span class=doctag>@author</span> ybd</span></span><br><span class=line><span class=comment> * <span class=doctag>@date</span> 17-10-19</span></span><br><span class=line><span class=comment> * </span></span><br><span class=line><span class=comment> * 懒汉式</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>LazySingleton</span> </span>&#123;</span><br><span class=line>	<span class=keyword>private</span> <span class=keyword>static</span> ReentrantLock reentrantLock = <span class=keyword>new</span> ReentrantLock();</span><br><span class=line>	<span class=keyword>private</span> <span class=keyword>static</span> LazySingleton instance = <span class=keyword>null</span>;</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>private</span> <span class=title>LazySingleton</span><span class=params>()</span> </span>&#123;&#125;</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>static</span> LazySingleton <span class=title>getInstance</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		<span class=keyword>try</span> &#123;</span><br><span class=line>			<span class=comment>/* 可重入所保证线程安全 */</span></span><br><span class=line>			reentrantLock.lock();</span><br><span class=line>			<span class=keyword>if</span> (instance == <span class=keyword>null</span>) &#123;</span><br><span class=line>				instance = <span class=keyword>new</span> LazySingleton();</span><br><span class=line>			&#125;</span><br><span class=line>			<span class=keyword>return</span> instance;</span><br><span class=line>		&#125; <span class=keyword>finally</span> &#123;</span><br><span class=line>			reentrantLock.unlock();</span><br><span class=line>		&#125;</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>每一次获取实例都需要同步, 性能极差, 不可取.<h2 id=双重检查加锁><a href=#双重检查加锁 class=headerlink title=双重检查加锁></a>双重检查加锁</h2><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.yangbingdong.singleton;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * <span class=doctag>@author</span> ybd</span></span><br><span class=line><span class=comment> * <span class=doctag>@date</span> 17-10-19.</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 双重检查加锁</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>DoubleCheckSingleton</span> </span>&#123;</span><br><span class=line>	<span class=keyword>private</span> <span class=keyword>static</span> ReentrantLock reentrantLock = <span class=keyword>new</span> ReentrantLock();</span><br><span class=line>	</span><br><span class=line>	<span class=comment>/**</span></span><br><span class=line><span class=comment>	 * 1.5后加上 volatile 关键字使得double check变得有意义</span></span><br><span class=line><span class=comment>	 */</span></span><br><span class=line>	<span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>volatile</span> DoubleCheckSingleton instance = <span class=keyword>null</span>;</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>private</span> <span class=title>DoubleCheckSingleton</span><span class=params>()</span> </span>&#123;&#125;</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>static</span> DoubleCheckSingleton <span class=title>getInstance</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		<span class=keyword>try</span> &#123;</span><br><span class=line>			<span class=keyword>if</span> (instance == <span class=keyword>null</span>) &#123;</span><br><span class=line>				reentrantLock.lock();</span><br><span class=line>				<span class=keyword>if</span> (instance == <span class=keyword>null</span>) &#123;</span><br><span class=line>					instance = <span class=keyword>new</span> DoubleCheckSingleton();</span><br><span class=line>				&#125;</span><br><span class=line>			&#125;</span><br><span class=line>			<span class=keyword>return</span> instance;</span><br><span class=line>		&#125;<span class=keyword>finally</span> &#123;</span><br><span class=line>			<span class=keyword>if</span>(reentrantLock.isHeldByCurrentThread())&#123;</span><br><span class=line>				reentrantLock.unlock();</span><br><span class=line>			&#125;</span><br><span class=line>		&#125;</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>double check模式需要在给<code>instance</code>加上<code>volatile</code>关键字, 作用是当线程中的变量<strong>发生变化</strong>时, 会<strong>强制写回主存</strong>, <strong>其他线程</strong>发现主存的变量地址发生改变, 也会<strong>强制读取主存</strong>的变量.<p>如果不加<code>volatile</code>关键字, 则有可能出现这样的情况:<p>线程A、B同时进入并通过了第一个<code>if (instance == null)</code>, 然后A获取了锁, A把<code>instance</code>实例化并释放锁, B获取锁, 但此时B自己的内存里的<code>instance</code>还是空（因为没有强制读取主存并不知道<code>instance</code>已经被实例化了）, 所以又实例化了一个对象. . .<h2 id=Lazy-initialization-holder-class模式><a href=#Lazy-initialization-holder-class模式 class=headerlink title="Lazy initialization holder class模式"></a>Lazy initialization holder class模式</h2><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.yangbingdong.singleton;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * <span class=doctag>@author</span> ybd</span></span><br><span class=line><span class=comment> * <span class=doctag>@date</span> 17-10-19.</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * Lazy initialization holder class模式</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>InnerClassSingleton</span> </span>&#123;</span><br><span class=line>	<span class=function><span class=keyword>private</span> <span class=title>InnerClassSingleton</span><span class=params>()</span> </span>&#123;&#125;</span><br><span class=line></span><br><span class=line>	<span class=keyword>private</span> <span class=keyword>static</span> <span class=class><span class=keyword>class</span> <span class=title>SingletonHolder</span> </span>&#123;</span><br><span class=line>		<span class=keyword>private</span> <span class=keyword>static</span> InnerClassSingleton singleton = <span class=keyword>new</span> InnerClassSingleton();</span><br><span class=line>	&#125;</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>static</span> InnerClassSingleton <span class=title>getInstance</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		<span class=keyword>return</span> SingletonHolder.singleton;</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>在JVM进行类加载的时候会保证数据是同步的, 我们采用内部类实现: 在内部类里面去创建对象实例.<br>只要应用中不使用内部类 JVM 就不会去加载这个单例类, 也就不会创建单例对象, 从而实现<strong>延迟加载</strong>和<strong>线程安全</strong>.<h2 id=枚举><a href=#枚举 class=headerlink title=枚举></a>枚举</h2><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.yangbingdong.singleton;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.function.Supplier;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * <span class=doctag>@author</span> ybd</span></span><br><span class=line><span class=comment> * <span class=doctag>@date</span> 17-10-19.</span></span><br><span class=line><span class=comment> *</span></span><br><span class=line><span class=comment> * 枚举就是一个单例</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=keyword>enum</span>  SingletonEnum implements Supplier&lt;String&gt; &#123;</span><br><span class=line>	SINGLETON &#123;</span><br><span class=line>		<span class=meta>@Override</span></span><br><span class=line>		<span class=function><span class=keyword>public</span> String <span class=title>get</span><span class=params>()</span> </span>&#123;</span><br><span class=line>			<span class=keyword>return</span> <span class=string>"I'm singleton"</span>;</span><br><span class=line>		&#125;</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>枚举天生就是一个单例, 并且是<strong>线程安全</strong>的, <strong>自由序列化</strong>的, 这意味着反序列化之后它还是原来的那个单例.<p>而其他的单例模式需要定义<code>readResolve()</code>方法, 反序列化的时候会调用此方法:<figure class="highlight plain"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br></pre><td class=code><pre><span class=line>private Object readResolve() &#123;</span><br><span class=line>        return instance;</span><br><span class=line> &#125;</span><br></pre></table></figure><h2 id=Java标准库中的单例模式><a href=#Java标准库中的单例模式 class=headerlink title=Java标准库中的单例模式></a>Java标准库中的单例模式</h2><p><code>java.lang.Runtime#getRuntime()</code>就是一个典型的代表.<br><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre><td class=code><pre><span class=line><span class=class><span class=keyword>class</span> <span class=title>Runtime</span> </span>&#123;</span><br><span class=line>	<span class=keyword>private</span> <span class=keyword>static</span> Runtime currentRuntime = <span class=keyword>new</span> Runtime();</span><br><span class=line> </span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>static</span> Runtime <span class=title>getRuntime</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		<span class=keyword>return</span> currentRuntime;</span><br><span class=line>	&#125;</span><br><span class=line> </span><br><span class=line>	<span class=function><span class=keyword>private</span> <span class=title>Runtime</span><span class=params>()</span> </span>&#123;&#125;</span><br><span class=line> </span><br><span class=line>	<span class=comment>//... </span></span><br><span class=line>&#125;</span><br></pre></table></figure><p>这个<code>currentRuntime</code>就是在初始化就已经加载了的.<h1 id=Simple-Factory-Pattern><a href=#Simple-Factory-Pattern class=headerlink title="Simple Factory Pattern"></a>Simple Factory Pattern</h1><p><img src=https://cdn.yangbingdong.com/img/design-pattern-creational/simple-factory.png alt><p>简单工厂模式又被称为<strong>静态工厂方法模式</strong>, 由<strong>一个</strong>工厂类根据传入的参数, 动态决定应该创建哪一个产品类（这些产品类继承自一个父类或接口）的实例.<p>将“类实例化的操作”与“使用对象的操作”分开, 让使用者不用知道具体参数就可以实例化出所需要的“产品”类, 从而避免了在客户端代码中显式指定, 实现了<strong>解耦</strong>；<br>即使用者可直接消费产品而不需要知道其生产的细节<h2 id=代码><a href=#代码 class=headerlink title=代码></a>代码</h2><p>定义人类接口:<br><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>interface</span> <span class=title>Human</span> </span>&#123;</span><br><span class=line>	<span class=comment>/**</span></span><br><span class=line><span class=comment>	 * 是个人都会讲话</span></span><br><span class=line><span class=comment>	 */</span></span><br><span class=line>	<span class=function><span class=keyword>void</span> <span class=title>talk</span><span class=params>()</span></span>;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>实现类（男人和女人）:<br><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>Man</span> <span class=keyword>implements</span> <span class=title>Human</span> </span>&#123;</span><br><span class=line>	<span class=meta>@Override</span></span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>void</span> <span class=title>talk</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		System.out.println(<span class=string>"I'm man! \n"</span>);</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>Woman</span> <span class=keyword>implements</span> <span class=title>Human</span> </span>&#123;</span><br><span class=line>	<span class=meta>@Override</span></span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>void</span> <span class=title>talk</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		System.out.println(<span class=string>"I'm woman! \n"</span>);</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>工厂类:<br><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.yangbingdong.simplefactory;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> <span class=keyword>static</span> com.yangbingdong.simplefactory.HumanFactory.HumanEnum.MAN;</span><br><span class=line><span class=keyword>import</span> <span class=keyword>static</span> com.yangbingdong.simplefactory.HumanFactory.HumanEnum.WOMAN;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * <span class=doctag>@author</span> ybd</span></span><br><span class=line><span class=comment> * <span class=doctag>@date</span> 17-10-19.</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>HumanFactory</span> </span>&#123;</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>private</span> <span class=title>HumanFactory</span><span class=params>()</span> </span>&#123;&#125;</span><br><span class=line></span><br><span class=line>	<span class=comment>/**</span></span><br><span class=line><span class=comment>	 * 工厂获取实例静态方法</span></span><br><span class=line><span class=comment>	 * <span class=doctag>@param</span> humanEnum 根据传进来的枚举获取对应的实例</span></span><br><span class=line><span class=comment>	 * <span class=doctag>@return</span> 返回的实例</span></span><br><span class=line><span class=comment>	 */</span></span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>static</span> Human <span class=title>getInstance</span><span class=params>(HumanEnum humanEnum)</span> </span>&#123;</span><br><span class=line>		<span class=keyword>if</span> (MAN.equals(humanEnum)) &#123;</span><br><span class=line>			System.out.println(<span class=string>"生产了男人"</span>);</span><br><span class=line>			<span class=keyword>return</span> <span class=keyword>new</span> Man();</span><br><span class=line>		&#125;<span class=keyword>else</span> <span class=keyword>if</span> (WOMAN.equals(humanEnum)) &#123;</span><br><span class=line>			System.out.println(<span class=string>"生产了女人"</span>);</span><br><span class=line>			<span class=keyword>return</span> <span class=keyword>new</span> Woman();</span><br><span class=line>		&#125;<span class=keyword>else</span> &#123;</span><br><span class=line>			System.out.println(<span class=string>"什么都没有生产"</span>);</span><br><span class=line>			<span class=keyword>return</span> <span class=keyword>null</span>;</span><br><span class=line>		&#125;</span><br><span class=line>	&#125;</span><br><span class=line></span><br><span class=line>	<span class=keyword>public</span> <span class=keyword>enum</span> HumanEnum &#123;</span><br><span class=line>		MAN,WOMAN</span><br><span class=line>	&#125;</span><br><span class=line></span><br><span class=line>&#125;</span><br></pre></table></figure><p>现在来测试一下:<br><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.yangbingdong.simplefactory;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> java.util.Optional;</span><br><span class=line></span><br><span class=line><span class=keyword>import</span> <span class=keyword>static</span> com.yangbingdong.simplefactory.HumanFactory.HumanEnum.*;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * <span class=doctag>@author</span> ybd</span></span><br><span class=line><span class=comment> * <span class=doctag>@date</span> 17-10-19.</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>SimpleFactoryTest</span> </span>&#123;</span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> </span>&#123;</span><br><span class=line>		invokeTalkIfNotNull(MAN);</span><br><span class=line></span><br><span class=line>		invokeTalkIfNotNull(WOMAN);</span><br><span class=line></span><br><span class=line>		invokeTalkIfNotNull(<span class=keyword>null</span>);</span><br><span class=line>	&#125;</span><br><span class=line></span><br><span class=line>	<span class=function><span class=keyword>private</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>invokeTalkIfNotNull</span><span class=params>(HumanFactory.HumanEnum man)</span> </span>&#123;</span><br><span class=line>		Optional.ofNullable(HumanFactory.getInstance(man)).ifPresent(Human::talk);</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>运行结果:<br><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre><td class=code><pre><span class=line>生产了男人</span><br><span class=line>I<span class=string>'m man! </span></span><br><span class=line><span class=string></span></span><br><span class=line><span class=string>生产了女人</span></span><br><span class=line><span class=string>I'</span>m woman! </span><br><span class=line></span><br><span class=line>什么都没有生产</span><br></pre></table></figure><h2 id=特点><a href=#特点 class=headerlink title=特点></a>特点</h2><p>将创建实例的工作与使用实例的工作分开, 使用者不必关心类对象如何创建, 只需要传入工厂需要的参数即可, 但也有<strong>弊端</strong>: 工厂类集中了所有实例（产品）的创建逻辑, 一旦这个工厂不能正常工作, 整个系统都会受到影响, 违背“开放 - 关闭原则”, 一旦添加新产品就不得不修改工厂类的逻辑, 这样就会造成工厂逻辑过于复杂, 对于系统维护和扩展不够友好.<h2 id=Java标准库中的简单工厂模式><a href=#Java标准库中的简单工厂模式 class=headerlink title=Java标准库中的简单工厂模式></a>Java标准库中的简单工厂模式</h2><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line>java.util.Calendar - getInstance()</span><br><span class=line>java.util.Calendar - getInstance(TimeZone zone)</span><br><span class=line>java.util.Calendar - getInstance(Locale aLocale)</span><br><span class=line>java.util.Calendar - getInstance(TimeZone zone, Locale aLocale)</span><br><span class=line>java.text.NumberFormat - getInstance()</span><br><span class=line>java.text.NumberFormat - getInstance(Locale inLocale)</span><br></pre></table></figure><h1 id=Factory-Method><a href=#Factory-Method class=headerlink title="Factory Method"></a>Factory Method</h1><p><img src=https://cdn.yangbingdong.com/img/design-pattern-creational/factory-method.png alt><p>工厂方法模式, 又称工厂模式、多态工厂模式和虚拟构造器模式, 通过定义工厂父类负责定义创建对象的公共接口, 而子类则负责生成具体的对象. 就是一个工厂生产一个专一产品.<h2 id=代码-1><a href=#代码-1 class=headerlink title=代码></a>代码</h2><p>人类接口与实现类与上面的一样<p>主要是把工厂抽象成了接口, 具体的人类由具体的工厂实现类创建.<p>工厂接口定义统一的创建人类的借口<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>interface</span> <span class=title>HumanFactory</span> </span>&#123;</span><br><span class=line>	<span class=comment>/**</span></span><br><span class=line><span class=comment>	 * 定义抽象工厂方法</span></span><br><span class=line><span class=comment>	 * <span class=doctag>@return</span></span></span><br><span class=line><span class=comment>	 */</span></span><br><span class=line>	<span class=function>Human <span class=title>createHuman</span><span class=params>()</span></span>;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>两个工厂实现类<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>ManFactory</span> <span class=keyword>implements</span> <span class=title>HumanFactory</span> </span>&#123;</span><br><span class=line>	<span class=meta>@Override</span></span><br><span class=line>	<span class=function><span class=keyword>public</span> Human <span class=title>createHuman</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		System.out.println(<span class=string>"生产了男人"</span>);</span><br><span class=line>		<span class=keyword>return</span> <span class=keyword>new</span> Man();</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>WomanFactory</span> <span class=keyword>implements</span> <span class=title>HumanFactory</span> </span>&#123;</span><br><span class=line>	<span class=meta>@Override</span></span><br><span class=line>	<span class=function><span class=keyword>public</span> Human <span class=title>createHuman</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		System.out.println(<span class=string>"生产了女人"</span>);</span><br><span class=line>		<span class=keyword>return</span> <span class=keyword>new</span> Woman();</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>测试类:<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> com.yangbingdong.factorymethod;</span><br><span class=line></span><br><span class=line><span class=comment>/**</span></span><br><span class=line><span class=comment> * <span class=doctag>@author</span> ybd</span></span><br><span class=line><span class=comment> * <span class=doctag>@date</span> 17-10-25.</span></span><br><span class=line><span class=comment> */</span></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>FactoryMethodTest</span> </span>&#123;</span><br><span class=line>   <span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> </span>&#123;</span><br><span class=line>      HumanFactory humanFactory = <span class=keyword>new</span> ManFactory();</span><br><span class=line>      humanFactory.createHuman().talk();</span><br><span class=line></span><br><span class=line>      humanFactory = <span class=keyword>new</span> WomanFactory();</span><br><span class=line>      humanFactory.createHuman().talk();</span><br><span class=line>   &#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>运行结果:<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line>生产了男人</span><br><span class=line>I<span class=string>'m man! </span></span><br><span class=line><span class=string></span></span><br><span class=line><span class=string>生产了女人</span></span><br><span class=line><span class=string>I'</span>m woman!</span><br></pre></table></figure><h2 id=特点-1><a href=#特点-1 class=headerlink title=特点></a>特点</h2><p>工厂方法模式把具体产品的创建推迟到工厂类的子类（具体工厂）中, 此时工厂类不再负责所有产品的创建, 而只是给出具体工厂必须实现的接口, 这样工厂方法模式在添加新产品的时候就不修改工厂类逻辑而是添加新的工厂子类, 符合<strong>开放封闭原则</strong>, 克服了简单工厂模式中缺点. 工厂模式可以说是简单工厂模式的进一步抽象和拓展, 在保留了简单工厂的封装优点的同时, 让扩展变得简单, 让继承变得可行, 增加了多态性的体现.<p>同时<strong>缺点</strong>也很明显, 多一个产品就多一个工厂, 开销变大了, 不适用与创建多种产品.<h2 id=Java中的工厂方法><a href=#Java中的工厂方法 class=headerlink title=Java中的工厂方法></a>Java中的工厂方法</h2><p>查找了一下, 数据库链接驱动就是一个典型的工厂方法模式, Java定义链接数据库以及其他操作的接口, 数据库厂商必须实现这些接口, 比如Mysql、Oracle.<h1 id=Abstract-Factory><a href=#Abstract-Factory class=headerlink title="Abstract Factory"></a>Abstract Factory</h1><p><img src=https://cdn.yangbingdong.com/img/design-pattern-creational/abstract-factory.png alt><p>抽象工厂模式为创建一组对象提供了一种解决方案. 与工厂方法模式相比, 抽象工厂模式中的具体工厂不只是创建一种产品, 它负责创建一族产品. 比如AMD工厂负责生产AMD全家桶, Intel工厂负责生产Intel全家桶.<h2 id=代码-2><a href=#代码-2 class=headerlink title=代码></a>代码</h2><p>首先定义CPU接口以及实现类<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>interface</span> <span class=title>CPU</span> </span>&#123;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>AMDCPU</span> <span class=keyword>implements</span> <span class=title>CPU</span> </span>&#123;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>IntelCPU</span> <span class=keyword>implements</span> <span class=title>CPU</span> </span>&#123;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>主板接口以及实现类<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>interface</span> <span class=title>MainBoard</span> </span>&#123;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>AMDMainBoard</span> <span class=keyword>implements</span> <span class=title>MainBoard</span> </span>&#123;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>IntelMainBoard</span> <span class=keyword>implements</span> <span class=title>MainBoard</span> </span>&#123;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>定义抽象工厂与实现类<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>interface</span> <span class=title>AbstractFactory</span> </span>&#123;</span><br><span class=line>	<span class=function>CPU <span class=title>createCPU</span><span class=params>()</span></span>;</span><br><span class=line></span><br><span class=line>	<span class=function>MainBoard <span class=title>createMainBoard</span><span class=params>()</span></span>;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>AMDFactory</span> <span class=keyword>implements</span> <span class=title>AbstractFactory</span> </span>&#123;</span><br><span class=line>	<span class=meta>@Override</span></span><br><span class=line>	<span class=function><span class=keyword>public</span> CPU <span class=title>createCPU</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		System.out.println(<span class=string>"生产了AMD的CPU"</span>);</span><br><span class=line>		<span class=keyword>return</span> <span class=keyword>new</span> AMDCPU();</span><br><span class=line>	&#125;</span><br><span class=line></span><br><span class=line>	<span class=meta>@Override</span></span><br><span class=line>	<span class=function><span class=keyword>public</span> MainBoard <span class=title>createMainBoard</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		System.out.println(<span class=string>"生产了AMD的主板"</span>);</span><br><span class=line>		<span class=keyword>return</span> <span class=keyword>new</span> AMDMainBoard();</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>IntelFactory</span> <span class=keyword>implements</span> <span class=title>AbstractFactory</span> </span>&#123;</span><br><span class=line>	<span class=meta>@Override</span></span><br><span class=line>	<span class=function><span class=keyword>public</span> CPU <span class=title>createCPU</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		System.out.println(<span class=string>"生产了Intel的CPU"</span>);</span><br><span class=line>		<span class=keyword>return</span> <span class=keyword>new</span> IntelCPU();</span><br><span class=line>	&#125;</span><br><span class=line></span><br><span class=line>	<span class=meta>@Override</span></span><br><span class=line>	<span class=function><span class=keyword>public</span> MainBoard <span class=title>createMainBoard</span><span class=params>()</span> </span>&#123;</span><br><span class=line>		System.out.println(<span class=string>"生产了Intel的主板"</span>);</span><br><span class=line>		<span class=keyword>return</span> <span class=keyword>new</span> IntelMainBoard();</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>测试类<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>AbstractFactoryTest</span> </span>&#123;</span><br><span class=line>	<span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> </span>&#123;</span><br><span class=line>		AbstractFactory abstractFactory = <span class=keyword>new</span> AMDFactory();</span><br><span class=line>		abstractFactory.createCPU();</span><br><span class=line>		abstractFactory.createMainBoard();</span><br><span class=line></span><br><span class=line>		abstractFactory = <span class=keyword>new</span> IntelFactory();</span><br><span class=line>		abstractFactory.createCPU();</span><br><span class=line>		abstractFactory.createMainBoard();</span><br><span class=line>	&#125;</span><br><span class=line>&#125;</span><br></pre></table></figure><p>运行结果<figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre><td class=code><pre><span class=line>生产了AMD的CPU</span><br><span class=line>生产了AMD的主板</span><br><span class=line>生产了Intel的CPU</span><br><span class=line>生产了Intel的主板</span><br></pre></table></figure><h2 id=优缺点><a href=#优缺点 class=headerlink title=优缺点></a>优缺点</h2><p><strong>优点</strong>:<p><strong>分离接口和实现</strong>: 客户端使用抽象工厂来创建需要的对象, 而客户端根本就不知道具体的实现是谁, 客户端只是面向产品的接口编程而已. 也就是说, 客户端从具体的产品实现中解耦.<p><strong>使切换产品族变得容易</strong>: 因为一个具体的工厂实现代表的是一个产品族, 比如上面例子的从Intel系列到AMD系列只需要切换一下具体工厂.<p><strong>缺点</strong>:<p><strong>不太容易扩展新的产品</strong>: 如果需要给整个产品族添加一个新的产品, 那么就需要修改抽象工厂, 这样就会导致修改所有的工厂实现类<h2 id=Java标准类库中的抽象工厂模式><a href=#Java标准类库中的抽象工厂模式 class=headerlink title=Java标准类库中的抽象工厂模式></a>Java标准类库中的抽象工厂模式</h2><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br></pre><td class=code><pre><span class=line><span class=keyword>package</span> java.util;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>interface</span> <span class=title>List</span>&lt;<span class=title>E</span>&gt; <span class=keyword>extends</span> <span class=title>Collection</span>&lt;<span class=title>E</span>&gt; </span>&#123;</span><br><span class=line>    </span><br><span class=line>    <span class=function>Iterator&lt;E&gt; <span class=title>iterator</span><span class=params>()</span></span>;<span class=comment>//一种产品</span></span><br><span class=line></span><br><span class=line>    Object[] toArray();</span><br><span class=line></span><br><span class=line>    &lt;T&gt; T[] toArray(T[] a);</span><br><span class=line></span><br><span class=line>    <span class=function>ListIterator&lt;E&gt; <span class=title>listIterator</span><span class=params>()</span></span>;<span class=comment>//另外一种产品</span></span><br><span class=line></span><br><span class=line>    <span class=function>ListIterator&lt;E&gt; <span class=title>listIterator</span><span class=params>(<span class=keyword>int</span> index)</span></span>;</span><br><span class=line></span><br><span class=line>&#125;</span><br></pre></table></figure><h1 id=Builder><a href=#Builder class=headerlink title=Builder></a>Builder</h1><p>将一个<strong>复杂</strong>对象的<strong>构建</strong>与它的表示<strong>分离</strong>, 使得同样的构建过程可以创建不同的表示.<p>使用<strong><em><a href=https://projectlombok.org rel="external nofollow noopener noreferrer" target=_blank>Lombok</a></em></strong>中的<code>@Builder</code>可以很简单地实现Builder模式, <code>@Accessors(chain = true)</code>也可以实现类似的模式.<h2 id=代码-3><a href=#代码-3 class=headerlink title=代码></a>代码</h2><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br><span class=line>35</span><br><span class=line>36</span><br><span class=line>37</span><br><span class=line>38</span><br><span class=line>39</span><br><span class=line>40</span><br><span class=line>41</span><br><span class=line>42</span><br><span class=line>43</span><br></pre><td class=code><pre><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>Summoner</span> </span>&#123;</span><br><span class=line></span><br><span class=line>    <span class=keyword>private</span> String name;</span><br><span class=line>    <span class=keyword>private</span> String type;</span><br><span class=line>    <span class=keyword>private</span> String innate;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>private</span> <span class=title>Summoner</span><span class=params>(Builder builder)</span> </span>&#123;</span><br><span class=line>        <span class=keyword>this</span>.name = builder.name;</span><br><span class=line>        <span class=keyword>this</span>.type = builder.type;</span><br><span class=line>        <span class=keyword>this</span>.innate = builder.innate;</span><br><span class=line>    &#125;</span><br><span class=line></span><br><span class=line>    <span class=keyword>protected</span> <span class=keyword>static</span> <span class=class><span class=keyword>class</span> <span class=title>Builder</span> </span>&#123;</span><br><span class=line>        <span class=keyword>private</span> String name;</span><br><span class=line>        <span class=keyword>private</span> String type;</span><br><span class=line>        <span class=keyword>private</span> String innate;</span><br><span class=line></span><br><span class=line>        <span class=function><span class=keyword>protected</span> Builder <span class=title>name</span><span class=params>(String name)</span> </span>&#123;</span><br><span class=line>            <span class=keyword>this</span>.name = name;</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>this</span>;</span><br><span class=line>        &#125;</span><br><span class=line></span><br><span class=line>        <span class=function><span class=keyword>protected</span> Builder <span class=title>type</span><span class=params>(String type)</span> </span>&#123;</span><br><span class=line>            <span class=keyword>this</span>.type = type;</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>this</span>;</span><br><span class=line>        &#125;</span><br><span class=line></span><br><span class=line>        <span class=function><span class=keyword>protected</span> Builder <span class=title>innate</span><span class=params>(String innate)</span> </span>&#123;</span><br><span class=line>            <span class=keyword>this</span>.innate = innate;</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>this</span>;</span><br><span class=line>        &#125;</span><br><span class=line>        <span class=function><span class=keyword>protected</span> Summoner <span class=title>build</span><span class=params>()</span> </span>&#123;</span><br><span class=line>            <span class=keyword>return</span> <span class=keyword>new</span> Summoner(<span class=keyword>this</span>);</span><br><span class=line>        &#125;</span><br><span class=line>    &#125;</span><br><span class=line>&#125;</span><br><span class=line></span><br><span class=line><span class=keyword>public</span> <span class=class><span class=keyword>class</span> <span class=title>BuilderDemo</span> </span>&#123;</span><br><span class=line></span><br><span class=line>    <span class=function><span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> <span class=title>main</span><span class=params>(String[] args)</span> </span>&#123;</span><br><span class=line>        Summoner monkey = <span class=keyword>new</span> Summoner.Builder().name(<span class=string>"齐天大圣 - 孙悟空"</span>).type(<span class=string>"上单 - AD"</span>).innate(<span class=string>"基石天赋 - 战争雷霆"</span>).build();</span><br><span class=line>        System.out.println(monkey.toString());</span><br><span class=line>&#125;</span><br></pre></table></figure><h2 id=优缺点-1><a href=#优缺点-1 class=headerlink title=优缺点></a>优缺点</h2><p>优点:<ul><li>封装性很好: 使用建造者模式可以有效的封装变化, 在使用建造者模式的场景中, 一般产品类和建造者类是比较稳定的, 因此, 将主要的业务逻辑封装在导演类中对整体而言可以取得比较好的稳定性.<li>扩展性很好: 建造者模式很容易进行扩展. 如果有新的需求, 通过实现一个新的建造者类就可以完成, 基本上不用修改之前已经测试通过的代码, 因此也就不会对原有功能引入风险.<li>可以有效控制细节风险: 由于具体的建造者是独立的, 因此可以对建造者过程逐步细化, 而不对其他的模块产生任何影响.</ul><p>缺点:<ul><li>建造者模式所创建的产品一般具有较多的共同点, 其组成部分相似, 如果产品之间的差异性很大, 则不适合使用建造者模式, 因此其使用范围受到一定的限制.<li>如果产品的内部变化复杂, 可能会导致需要定义很多具体建造者类来实现这种变化, 导致系统变得很庞大.</ul><h2 id=Java类库中的建造者模式><a href=#Java类库中的建造者模式 class=headerlink title=Java类库中的建造者模式></a>Java类库中的建造者模式</h2><figure class="highlight java"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre><td class=code><pre><span class=line>StringBuilder strBuilder= <span class=keyword>new</span> StringBuilder();</span><br><span class=line>strBuilder.append(<span class=string>"one"</span>);</span><br><span class=line>strBuilder.append(<span class=string>"two"</span>);</span><br><span class=line>strBuilder.append(<span class=string>"three"</span>);</span><br><span class=line>String str= strBuilder.toString();</span><br></pre></table></figure><h1 id=Prototype><a href=#Prototype class=headerlink title=Prototype></a>Prototype</h1><p>原型模式是<code>23GOF</code>模式的一种, 其特点就是通过<strong>克隆/拷贝</strong>的方式来, 节约创建成本和资源, 被拷贝`的对象模型就称之为<strong>原型</strong>.<p>JAVA中对原型模式提供了良好的支持, 我们只需要实现<code>Cloneable</code>接口即可, 它的目的就是将对象标记为可被复制.<p>一般的应用场景是, 对象的创建非常复杂, 可以使用原型模式快捷的创建对象；或在运行过程中不知道对象的具体类型, 可使用原型模式创建一个相同类型的对象, 或者在运行过程中动态的获取到一个对象的状态.<h2 id=优缺点-2><a href=#优缺点-2 class=headerlink title=优缺点></a>优缺点</h2><p>优点:<ul><li>由于clone方法是由虚拟机直接复制内存块执行, 所以在速度上比使用new的方式创建对象要快.<li>可以基于原型, 快速的创建一个对象, 而无需知道创建的细节.<li>可以在运行时动态的获取对象的类型以及状态, 从而创建一个对象.</ul><p>缺点:<ul><li>需要实现 <code>Cloneable</code>接口, <code>clone</code>位于内部, 不易扩展, 容易违背<code>开闭原则</code>(程序扩展,不应该修改原有代码).<li>默认的 <code>clone</code> 只是浅克隆, 深度克隆需要额外编码比如: 统一实现<code>Cloneable</code>接口, 或者<strong>序列化</strong>方式.</ul><p>代码就不贴了, 实际开发中估计用不到, 但有一句话说得很对: 存在即合理.<p>原型模式一般伴随这工厂模式, 代码可参考: <strong><em><a href=https://github.com/masteranthoneyd/design-pattern-java/tree/master/creational/src/com/yangbingdong/prototype rel="external nofollow noopener noreferrer" target=_blank>https://github.com/masteranthoneyd/design-pattern-java/tree/master/creational/src/com/yangbingdong/prototype</a></em></strong></div><div style=text-align:center;color:#ccc;font-size:14px>---------------- The End ----------------</div><div><div id=wechat_subscriber style="display:block;padding:10px 0;margin:20px auto;width:100%;text-align:center"><img id=wechat_subscriber_qcode src=/images/wechat/gongzhonghao.jpg alt="ookamiAntD wechat" style=width:200px;max-width:100%><div>欢迎您扫一扫上面的微信公众号，订阅我的博客！</div></div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>谢谢大爷～</div><button id=rewardButton disable=enable onclick="var qr=document.getElementById('QR');if(qr.style.display==='none'){qr.style.display='block';}else{qr.style.display='none'}">
<span>赏</span></button><div id=QR style=display:none><div id=wechat style=display:inline-block><img id=wechat_qr src=/images/donate/wechat.png alt="ookamiAntD WeChat Pay"><p>微信打赏</div><div id=alipay style=display:inline-block><img id=alipay_qr src=/images/donate/alipay.jpg alt="ookamiAntD Alipay"><p>支付宝打赏</div></div></div></div><div><p id=div-border-left-red>Author：<b>ookamiAntD Yang</b><br>Link：<a href=/2018/design-pattern-creational/ title=设计模式之创建型(Creational)>http://yangbingdong.com/2018/design-pattern-creational/</a><br>Contact：<a>yangbingdong1994@gmail.com</a><br><b>本文基于<a target=_blank title="Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)" href=http://creativecommons.org/licenses/by-sa/4.0/ rel="external nofollow noopener noreferrer"> 知识共享署名-相同方式共享 4.0 </a>国际许可协议发布</b><br><b>转载请注明出处，谢谢！</b></div><footer class=post-footer><div class=post-tags><a href=/tags/Java/ rel=tag><i class="fa fa-tag"></i>Java</a>
<a href=/tags/Design-Pattern/ rel=tag><i class="fa fa-tag"></i>Design Pattern</a></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/2018/spring-cloud-stack-learning/ rel=next title="Spring Cloud Stack Learning"><i class="fa fa-chevron-left"></i>Spring Cloud Stack Learning</a></div><span class=post-nav-divider></span><div class="post-nav-prev post-nav-item"><a href=/2018/spring-boot-learning-testing/ rel=prev title="Spring Boot学习之测试篇">Spring Boot学习之测试篇 <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class=post-spread><div class=-hoofoo-share-title>分享到：</div><div class=-hoofoo-share-buttons><div class="-mob-share-weibo -hoofoo-share-weibo -hoofoo-share-ui-button"><i class="fa fa-weibo" aria-hidden=true></i></div><div class="-mob-share-weixin -hoofoo-share-weixin -hoofoo-share-ui-button"><i class="fa fa-weixin" aria-hidden=true></i></div><div class="-mob-share-qq -hoofoo-share-qq -hoofoo-share-ui-button"><i class="fa fa-qq" aria-hidden=true></i></div><div class="-mob-share-twitter -hoofoo-share-twitter -hoofoo-share-ui-button"><i class="fa fa-twitter" aria-hidden=true></i></div><div class="-hoofoo-share-more -hoofoo-share-ui-button -mob-share-open"><i class="fa fa-ellipsis-h" aria-hidden=true></i></div></div><div class=-mob-share-ui style=display:none><ul class=-mob-share-list><li class=-mob-share-weibo><p>新浪微博<li class=-mob-share-weixin><p>微信<li class=-mob-share-qzone><p>QQ空间<li class=-mob-share-qq><p>QQ好友<li class=-mob-share-tencentweibo><p>腾讯微博<li class=-mob-share-renren><p>人人网<li class=-mob-share-kaixin><p>开心网<li class=-mob-share-douban><p>豆瓣<li class=-mob-share-youdao><p>有道云笔记<li class=-mob-share-mingdao><p>明道<li class=-mob-share-pengyou><p>朋友网<li class=-mob-share-facebook><p>Facebook<li class=-mob-share-twitter><p>Twitter<li class=-mob-share-pocket><p>Pocket<li class=-mob-share-google><p>Google+<li class=-mob-share-tumblr><p>Tumblr<li class=-mob-share-instapaper><p>Instapaper<li class=-mob-share-linkedin><p>Linkedin</ul><div class=-mob-share-close>取消</div></div><div class=-mob-share-ui-bg></div><script id=-mob-share src="https://f1.webshare.mob.com/code/mob-share.js?appkey=21aa3b13ad233"></script></div></div></div><div class=comments id=comments><div style=text-align:center></div><div id=disqus_proxy_thread></div><div id=disqus_thread></div><script>window.disqusProxy={username:'ookamiantd',server:'disqus-proxy.yangbingdong.com',port:'',defaultAvatar:'/images/avatar/avatar-default.jpg',adminAvatar:'/images/avatar/avatar-admin.jpg',identifier:'2018/design-pattern-creational/'};window.disqus_config=function(){this.page.url='http://yangbingdong.com/2018/design-pattern-creational/';this.page.identifier='2018/design-pattern-creational/';};window.onload=function(){var s=document.createElement('script');s.src="/static/js/main.0d0338ae.js";s.async=true;document.body.appendChild(s);}</script><link rel=stylesheet href=/static/css/main.0603c539.css></div></div><div class=sidebar-toggle><div class=sidebar-toggle-line-wrap><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id=sidebar class=sidebar><div class=sidebar-inner><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target=post-toc-wrap>Table of Contents<li class=sidebar-nav-overview data-target=site-overview>Overview</ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image src=/images/avatar/avatar-admin.jpg alt=ookamiAntD><p class=site-author-name itemprop=name>ookamiAntD<p class="site-description motion-element" itemprop=description>码渣 | rocker | 二次元 | 美剧 | 宅</div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href=/archives><span class=site-state-item-count>47</span>
<span class=site-state-item-name>posts</span></a></div><div class="site-state-item site-state-categories"><a href=/categories><span class=site-state-item-count>18</span>
<span class=site-state-item-name>categories</span></a></div><div class="site-state-item site-state-tags"><a href=/tags><span class=site-state-item-count>44</span>
<span class=site-state-item-name>tags</span></a></div></nav><div class="feed-link motion-element"><a href=/atom.xml rel=alternate><i class="fa fa-rss"></i>RSS</a></div><div class="links-of-author motion-element"><span class=links-of-author-item><a href=https://github.com/masteranthoneyd target=_blank rel="external nofollow noopener noreferrer" title=GitHub><i class="fa fa-fw fa-github"></i>GitHub</a></span>
<span class=links-of-author-item><a href="https://www.facebook.com/profile.php?id=100014869064462" target=_blank rel="external nofollow noopener noreferrer" title=Facebook><i class="fa fa-fw fa-facebook"></i>Facebook</a></span>
<span class=links-of-author-item><a href=https://twitter.com/ookamiAntD target=_blank rel="external nofollow noopener noreferrer" title=Twitter><i class="fa fa-fw fa-twitter"></i>Twitter</a></span></div><div class="cc-license motion-element" itemprop=license><a href=https://creativecommons.org/licenses/by-sa/4.0/ class=cc-opacity target=_blank rel="external nofollow noopener noreferrer"><img src=/images/cc-by-sa.svg alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class=links-of-blogroll-title><i class="fa  fa-fw fa-globe"></i>大神们的博客</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://mercyblitz.github.io/ title=mercyblitz(Java劝退师) target=_blank rel="external nofollow noopener noreferrer">mercyblitz(Java劝退师)</a><li class=links-of-blogroll-item><a href=https://muyinchen.github.io/ title=知秋大神(真·大神) target=_blank rel="external nofollow noopener noreferrer">知秋大神(真·大神)</a><li class=links-of-blogroll-item><a href=http://crossoverjie.top/ title="crossoverJie's Blog" target=_blank rel="external nofollow noopener noreferrer">crossoverJie's Blog</a><li class=links-of-blogroll-item><a href=http://yemengying.com/ title="Giraffe's Home" target=_blank rel="external nofollow noopener noreferrer">Giraffe's Home</a></ul></div><div id=days></div><script>function show_date_time(){window.setTimeout("show_date_time()",1000);BirthDay=new Date("01/10/2017 12:34:56");today=new Date();timeold=(today.getTime()-BirthDay.getTime());sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);e_hrsold=(e_daysold-daysold)*24;hrsold=setzero(Math.floor(e_hrsold));e_minsold=(e_hrsold-hrsold)*60;minsold=setzero(Math.floor((e_hrsold-hrsold)*60));seconds=setzero(Math.floor((e_minsold-minsold)*60));document.getElementById('days').innerHTML="已运行"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";}
function setzero(i){if(i<10)
{i="0"+i};return i;}
show_date_time();</script></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class=post-toc><div class=post-toc-content><ol class=nav><li class="nav-item nav-level-1"><a class=nav-link href=#Preface><span class=nav-number>1.</span> <span class=nav-text>Preface</span></a><li class="nav-item nav-level-1"><a class=nav-link href=#Singleton-Pattern><span class=nav-number>2.</span> <span class=nav-text>Singleton Pattern</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#小学生式单例模式><span class=nav-number>2.1.</span> <span class=nav-text>小学生式单例模式</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#饿汉式><span class=nav-number>2.2.</span> <span class=nav-text>饿汉式</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#懒汉式><span class=nav-number>2.3.</span> <span class=nav-text>懒汉式</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#双重检查加锁><span class=nav-number>2.4.</span> <span class=nav-text>双重检查加锁</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Lazy-initialization-holder-class模式><span class=nav-number>2.5.</span> <span class=nav-text>Lazy initialization holder class模式</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#枚举><span class=nav-number>2.6.</span> <span class=nav-text>枚举</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Java标准库中的单例模式><span class=nav-number>2.7.</span> <span class=nav-text>Java标准库中的单例模式</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#Simple-Factory-Pattern><span class=nav-number>3.</span> <span class=nav-text>Simple Factory Pattern</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#代码><span class=nav-number>3.1.</span> <span class=nav-text>代码</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#特点><span class=nav-number>3.2.</span> <span class=nav-text>特点</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Java标准库中的简单工厂模式><span class=nav-number>3.3.</span> <span class=nav-text>Java标准库中的简单工厂模式</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#Factory-Method><span class=nav-number>4.</span> <span class=nav-text>Factory Method</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#代码-1><span class=nav-number>4.1.</span> <span class=nav-text>代码</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#特点-1><span class=nav-number>4.2.</span> <span class=nav-text>特点</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Java中的工厂方法><span class=nav-number>4.3.</span> <span class=nav-text>Java中的工厂方法</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#Abstract-Factory><span class=nav-number>5.</span> <span class=nav-text>Abstract Factory</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#代码-2><span class=nav-number>5.1.</span> <span class=nav-text>代码</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#优缺点><span class=nav-number>5.2.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Java标准类库中的抽象工厂模式><span class=nav-number>5.3.</span> <span class=nav-text>Java标准类库中的抽象工厂模式</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#Builder><span class=nav-number>6.</span> <span class=nav-text>Builder</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#代码-3><span class=nav-number>6.1.</span> <span class=nav-text>代码</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#优缺点-1><span class=nav-number>6.2.</span> <span class=nav-text>优缺点</span></a><li class="nav-item nav-level-2"><a class=nav-link href=#Java类库中的建造者模式><span class=nav-number>6.3.</span> <span class=nav-text>Java类库中的建造者模式</span></a></ol><li class="nav-item nav-level-1"><a class=nav-link href=#Prototype><span class=nav-number>7.</span> <span class=nav-text>Prototype</span></a><ol class=nav-child><li class="nav-item nav-level-2"><a class=nav-link href=#优缺点-2><span class=nav-number>7.1.</span> <span class=nav-text>优缺点</span></a></ol></ol></div></div></section></div></aside></div></main><footer id=footer class=footer><div class=footer-inner><div class=busuanzi-count><script async src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span class=site-uv><i class="fa fa-user">本站访客数</i><span class=busuanzi-value id=busuanzi_value_site_uv></span>人次</span>
<span class=site-pv><i class="fa fa-eye">本站总访问量</i><span class=busuanzi-value id=busuanzi_value_site_pv></span>次</span></div><div class=copyright>&copy; 2016 -
<span itemprop=copyrightYear>2020</span>
<span class=with-love><i class="fa fa-flash"></i></span><span class=author itemprop=copyrightHolder>Hosted by <a href=https://pages.coding.me style=font-weight:700 rel="external nofollow noopener noreferrer" target=_blank>Coding Pages</a></span> | <span class=post-count>共280.0k字</span></div><div class=theme-info><a target=_blank href=http://www.miibeian.gov.cn/ rel=nofollow style=color:#555>粤ICP备18135202号-1</a></div><div style="width:300px;margin:0 auto"><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44010602005896" style=display:inline-block;text-decoration:none;height:20px;line-height:20px><img src=https://cdn.yangbingdong.com/img/beian/beian.png style=float:left><p style="float:left;height:20px;line-height:20px;margin:0 0 0 5px;color:#555">粤公网安备 44010602005896号</p></a></div></div></footer><div class=back-to-top><i class="fa fa-arrow-up"></i></div></div><script>if(Object.prototype.toString.call(window.Promise)!=='[object Function]'){window.Promise=null;}</script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script src="/js/src/utils.js?v=5.1.0"></script><script src="/js/src/motion.js?v=5.1.0"></script><script src="/js/src/scrollspy.js?v=5.1.0"></script><script src="/js/src/post-details.js?v=5.1.0"></script><script src="/js/src/bootstrap.js?v=5.1.0"></script><script>var disqus_shortname='ookamiantd';var disqus_identifier='2018/design-pattern-creational/';var disqus_title="设计模式之创建型(Creational)";function run_disqus_script(disqus_script){var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;dsq.src='//'+disqus_shortname+'.disqus.com/'+disqus_script;(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);}
var disqus={load:function disqus(){if(typeof DISQUS!=='object'){(function(){var s=document.createElement('script');s.async=true;s.type='text/javascript';s.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('HEAD')[0]||document.getElementsByTagName('BODY')[0]).appendChild(s);}());$('#load-disqus').html("评论加载中，请确保你有梯子，若评论长时间未加载则你可能翻墙失败...").fadeOut(9000);}}}</script><script>var isfetched=false;var search_path="search.xml";if(search_path.length==0){search_path="search.xml";}
var path="/"+search_path;function proceedsearch(){$("body").append('<div class="popoverlay">').css('overflow','hidden');$('.popup').toggle();}
var searchFunc=function(path,search_id,content_id){'use strict';$.ajax({url:path,dataType:"xml",async:true,success:function(xmlResponse){isfetched=true;$('.popup').detach().appendTo('.header-inner');var datas=$("entry",xmlResponse).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()};}).get();var $input=document.getElementById(search_id);var $resultContent=document.getElementById(content_id);$input.addEventListener('input',function(){var matchcounts=0;var str='<ul class=\"search-result-list\">';var keywords=this.value.trim().toLowerCase().split(/[\s\-]+/);$resultContent.innerHTML="";if(this.value.trim().length>1){datas.forEach(function(data){var isMatch=false;var content_index=[];var data_title=data.title.trim().toLowerCase();var data_content=data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();var data_url=decodeURIComponent(data.url);var index_title=-1;var index_content=-1;var first_occur=-1;if(data_title!=''){keywords.forEach(function(keyword,i){index_title=data_title.indexOf(keyword);index_content=data_content.indexOf(keyword);if(index_title>=0||index_content>=0){isMatch=true;if(i==0){first_occur=index_content;}}});}
if(isMatch){matchcounts+=1;str+="<li><a href='"+data_url+"' class='search-result-title'>"+data_title+"</a>";var content=data.content.trim().replace(/<[^>]+>/g,"");if(first_occur>=0){var start=first_occur-20;var end=first_occur+80;if(start<0){start=0;}
if(start==0){end=50;}
if(end>content.length){end=content.length;}
var match_content=content.substring(start,end);keywords.forEach(function(keyword){var regS=new RegExp(keyword,"gi");match_content=match_content.replace(regS,"<b class=\"search-keyword\">"+keyword+"</b>");});str+="<p class=\"search-result\">"+match_content+"...</p>"}
str+="</li>";}})};str+="</ul>";if(matchcounts==0){str='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'}
if(keywords==""){str='<div id="no-result"><i class="fa fa-search fa-5x" /></div>'}
$resultContent.innerHTML=str;});proceedsearch();}});}
$('.popup-trigger').click(function(e){e.stopPropagation();if(isfetched==false){searchFunc(path,'local-search-input','local-search-result');}else{proceedsearch();};});$('.popup-btn-close').click(function(e){$('.popup').hide();$(".popoverlay").remove();$('body').css('overflow','');});$('.popup').click(function(e){e.stopPropagation();});</script><script src=https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js></script><script>AV.initialize("usE0s6JGUeOiMcsVoRuHuv2B-gzGzoHsz","ewm6NEF07r83HbnOr63ptuKH");</script><script>function showTime(Counter){var query=new AV.Query(Counter);var entries=[];var $visitors=$(".leancloud_visitors");$visitors.each(function(){entries.push($(this).attr("id").trim());});query.containedIn('url',entries);query.find().done(function(results){var COUNT_CONTAINER_REF='.leancloud-visitors-count';if(results.length===0){$visitors.find(COUNT_CONTAINER_REF).text(0);return;}
for(var i=0;i<results.length;i++){var item=results[i];var url=item.get('url');var time=item.get('time');var element=document.getElementById(url);$(element).find(COUNT_CONTAINER_REF).text(time);}
for(var i=0;i<entries.length;i++){var url=entries[i];var element=document.getElementById(url);var countSpan=$(element).find(COUNT_CONTAINER_REF);if(countSpan.text()==''){countSpan.text(0);}}}).fail(function(object,error){console.log("Error: "+error.code+" "+error.message);});}
function addCount(Counter){var $visitors=$(".leancloud_visitors");var url=$visitors.attr('id').trim();var title=$visitors.attr('data-flag-title').trim();var query=new AV.Query(Counter);query.equalTo("url",url);query.find({success:function(results){if(results.length>0){var counter=results[0];counter.fetchWhenSave(true);counter.increment("time");counter.save(null,{success:function(counter){var $element=$(document.getElementById(url));$element.find('.leancloud-visitors-count').text(counter.get('time'));},error:function(counter,error){console.log('Failed to save Visitor num, with error message: '+error.message);}});}else{var newcounter=new Counter();var acl=new AV.ACL();acl.setPublicReadAccess(true);acl.setPublicWriteAccess(true);newcounter.setACL(acl);newcounter.set("title",title);newcounter.set("url",url);newcounter.set("time",1);newcounter.save(null,{success:function(newcounter){var $element=$(document.getElementById(url));$element.find('.leancloud-visitors-count').text(newcounter.get('time'));},error:function(newcounter,error){console.log('Failed to create');}});}},error:function(error){console.log('Error:'+error.code+" "+error.message);}});}
$(function(){var Counter=AV.Object.extend("Counter");if($('.leancloud_visitors').length==1){addCount(Counter);}else if($('.post-title-link').length>1){showTime(Counter);}});</script><script>(function(){var bp=document.createElement('script');var curProtocol=window.location.protocol.split(':')[0];if(curProtocol==='https'){bp.src='https://zz.bdstatic.com/linksubmit/push.js';}
else{bp.src='http://push.zhanzhang.baidu.com/push.js';}
var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script><script color=255,0,204 opacity=0.5 zindex=-2 count=40 src=//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js></script><script>$('body').delegate('.-mob-share-weixin-qrcode-bg','click',function(){$(".-mob-share-weixin-qrcode-close").trigger("click");});</script><canvas class=fireworks style=position:fixed;left:0;top:0;z-index:1;pointer-events:none></canvas>
<script src=//cdn.bootcss.com/animejs/2.2.0/anime.min.js></script><script src=/js/src/fireworks.js></script><script src=/js/src/dytitle.js></script></div></footer></div><script src=/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"superSample":2,"width":88,"height":88,"position":"left"},"mobile":{"show":false},"react":{"opacityDefault":0.9,"opacityOnHover":0.5},"log":false});</script>